# RDS 连接配置检查清单

## 当前问题
- 域名解析到内网地址：`172.20.186.209`
- 本地无法访问内网地址

## 解决方案

### 方案 1：使用公网地址（推荐）

1. **检查 RDS 是否有公网地址**
   - 登录阿里云控制台
   - 进入 RDS 实例详情页
   - 查看"连接信息"部分
   - 确认是否有"外网地址"

2. **如果没有公网地址，申请外网地址**
   - 在 RDS 实例详情页，点击"申请外网地址"
   - 等待几分钟生效

3. **更新 .env 文件**
   - 使用公网地址替换当前地址
   - 格式：`mysql://用户名:密码@公网地址:3306/tcm_supply_chain`

### 方案 2：使用内网地址（需要 ECS 服务器）

如果您有阿里云 ECS 服务器：
1. 在 ECS 服务器上运行后端服务
2. 使用内网地址连接（速度更快，免费）

### 方案 3：使用 SSH 隧道（临时方案）

通过 ECS 服务器建立 SSH 隧道：

```bash
# 在本地执行
ssh -L 3307:pc-bp186uf9xw9p7om6s.mysql.polardb.rds.aliyuncs.com:3306 root@您的ECS服务器IP

# 然后更新 .env 文件
DATABASE_URL="mysql://junhaidebug:密码@localhost:3307/tcm_supply_chain"
```

## 检查步骤

### 1. 确认白名单配置
- [ ] 已添加您的公网 IP 到白名单
- [ ] 白名单格式正确（IP/32 或 IP/24）

### 2. 确认外网地址
- [ ] RDS 实例已开启外网访问
- [ ] 有外网地址（不是内网地址）

### 3. 确认连接字符串
- [ ] 使用外网地址（不是内网地址）
- [ ] 用户名和密码正确
- [ ] 数据库名称正确

## 如何获取公网地址

1. 登录 [阿里云控制台](https://rdsnext.console.aliyun.com)
2. 进入 **云数据库 RDS** → **实例列表**
3. 找到您的实例，点击实例 ID
4. 在 **连接信息** 中查看：
   - **内网地址**：只能在 ECS 服务器上使用
   - **外网地址**：可以从本地访问（需要先申请）

## 如果只有内网地址

如果您只有内网地址，有两个选择：

### 选择 1：申请外网地址
- 在 RDS 实例详情页申请外网地址
- 配置白名单
- 使用外网地址连接

### 选择 2：在 ECS 服务器上运行
- 将代码部署到 ECS 服务器
- 使用内网地址连接（更快更安全）



